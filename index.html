<!DOCType html>
<html>
<head>
    <link href="/favicon.ico" rel="icon" type="image/x-icon" />
    <meta charset="utf-8">
    <title>TsDemuxerJS - https://github.com/numberwolf/h265web.js</title>
    <meta charset="utf-8" name="author" content="ChangYanlong">
    <meta charset="utf-8" name="email" content="porschegt23@foxmail.com">
    <meta charset="utf-8" name="discord" content="numberwolf#8694">
    <meta charset="utf-8" name="github" content="https://github.com/numberwolf/h265web.js">
    <script src='dist/play.js'></script>
</head>
<body>
    <script>
        var callback = () => {
            var mediaInfo = demuxer.readMediaInfo();
            console.log(mediaInfo);

            var extInfo = demuxer.readExtensionInfo();
            console.log(extInfo);

            var readData = null;
            var vcount = 0;
            var acount = 0;
            while(1) {
                readData = demuxer.readPacket();
                if (readData.size <= 0) {
                    break;
                }
                if (readData.type == 0) {
                    vcount++;
                } else {
                    acount++;
                    // console.log(readData.ptime, readData.size);
                }
                console.log(readData);
            }
            // console.log(vcount, acount);
        };

        var url = "/res/veilside.ts";
        var config = {};
    	var demuxer = makeTsDemuxerJs(url, config);
        demuxer.do(callback);


        // while (1) {
        //     demuxer.readPacket();
        // }
	</script>
</body>
</html>
